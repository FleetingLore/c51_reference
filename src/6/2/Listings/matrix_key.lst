C51 COMPILER V9.60.7.0   MATRIX_KEY                                                        11/21/2025 20:24:12 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MATRIX_KEY
OBJECT MODULE PLACED IN .\Objects\matrix_key.obj
COMPILER INVOKED BY: D:\C51\BIN\C51.EXE matrix_key.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\matrix
                    -_key.lst) OBJECT(.\Objects\matrix_key.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          #include "delay.h"
   4          
   5          /// 无符号整数类型的别名
   6          #define uchar unsigned char
   7          #define uint  unsigned int
   8          
   9          /// 延时参数
  10          const uint AWAIT = 20;
  11          
  12          /**
  13           * [矩阵键盘读取按键键码]
  14           * 
  15           * 逐列扫描以确定按键
  16           * 
  17           * 若无按键被按下，返回 `0`
  18           * 
  19           * 否则返回键码
  20           */
  21          uchar matrix_key() {
  22   1          uchar key_number = 0;
  23   1          
  24   1          P1 = 0xFF;
  25   1          P1_3 = 0;
  26   1          
  27   1          if (P1_7 == 0) {
  28   2              delay_ms(AWAIT);
  29   2              while (P1_7 == 0);
  30   2              delay_ms(AWAIT);
  31   2              
  32   2              key_number = 1;
  33   2          }
  34   1          
  35   1          if (P1_6 == 0) {
  36   2              delay_ms(AWAIT);
  37   2              while (P1_7 == 0);
  38   2              delay_ms(AWAIT);
  39   2              
  40   2              key_number = 5;
  41   2          }
  42   1          
  43   1          if (P1_5 == 0) {
  44   2              delay_ms(AWAIT);
  45   2              while (P1_7 == 0);
  46   2              delay_ms(AWAIT);
  47   2              
  48   2              key_number = 9;
  49   2          }
  50   1          
  51   1          if (P1_4 == 0) {
  52   2              delay_ms(AWAIT);
  53   2              while (P1_7 == 0);
  54   2              delay_ms(AWAIT);
C51 COMPILER V9.60.7.0   MATRIX_KEY                                                        11/21/2025 20:24:12 PAGE 2   

  55   2              
  56   2              key_number = 13;
  57   2          }
  58   1          
  59   1          P1 = 0xFF;
  60   1          P1_2 = 0;
  61   1          
  62   1          if (P1_7 == 0) {
  63   2              delay_ms(AWAIT);
  64   2              while (P1_7 == 0);
  65   2              delay_ms(AWAIT);
  66   2              
  67   2              key_number = 2;
  68   2          }
  69   1          
  70   1          if (P1_6 == 0) {
  71   2              delay_ms(AWAIT);
  72   2              while (P1_7 == 0);
  73   2              delay_ms(AWAIT);
  74   2              
  75   2              key_number = 6;
  76   2          }
  77   1          
  78   1          if (P1_5 == 0) {
  79   2              delay_ms(AWAIT);
  80   2              while (P1_7 == 0);
  81   2              delay_ms(AWAIT);
  82   2              
  83   2              key_number = 10;
  84   2          }
  85   1          
  86   1          if (P1_4 == 0) {
  87   2              delay_ms(AWAIT);
  88   2              while (P1_7 == 0);
  89   2              delay_ms(AWAIT);
  90   2              
  91   2              key_number = 14;
  92   2          }
  93   1          
  94   1          P1 = 0xFF;
  95   1          P1_1 = 0;
  96   1          
  97   1          if (P1_7 == 0) {
  98   2              delay_ms(AWAIT);
  99   2              while (P1_7 == 0);
 100   2              delay_ms(AWAIT);
 101   2              
 102   2              key_number = 3;
 103   2          }
 104   1          
 105   1          if (P1_6 == 0) {
 106   2              delay_ms(AWAIT);
 107   2              while (P1_7 == 0);
 108   2              delay_ms(AWAIT);
 109   2              
 110   2              key_number = 7;
 111   2          }
 112   1          
 113   1          if (P1_5 == 0) {
 114   2              delay_ms(AWAIT);
 115   2              while (P1_7 == 0);
 116   2              delay_ms(AWAIT);
C51 COMPILER V9.60.7.0   MATRIX_KEY                                                        11/21/2025 20:24:12 PAGE 3   

 117   2              
 118   2              key_number = 11;
 119   2          }
 120   1          
 121   1          if (P1_4 == 0) {
 122   2              delay_ms(AWAIT);
 123   2              while (P1_7 == 0);
 124   2              delay_ms(AWAIT);
 125   2              
 126   2              key_number = 15;
 127   2          }
 128   1          
 129   1          P1 = 0xFF;
 130   1          P1_0 = 0;
 131   1          
 132   1          if (P1_7 == 0) {
 133   2              delay_ms(AWAIT);
 134   2              while (P1_7 == 0);
 135   2              delay_ms(AWAIT);
 136   2              
 137   2              key_number = 4;
 138   2          }
 139   1          
 140   1          if (P1_6 == 0) {
 141   2              delay_ms(AWAIT);
 142   2              while (P1_7 == 0);
 143   2              delay_ms(AWAIT);
 144   2              
 145   2              key_number = 8;
 146   2          }
 147   1          
 148   1          if (P1_5 == 0) {
 149   2              delay_ms(AWAIT);
 150   2              while (P1_7 == 0);
 151   2              delay_ms(AWAIT);
 152   2              
 153   2              key_number = 12;
 154   2          }
 155   1          
 156   1          if (P1_4 == 0) {
 157   2              delay_ms(AWAIT);
 158   2              while (P1_7 == 0);
 159   2              delay_ms(AWAIT);
 160   2              
 161   2              key_number = 16;
 162   2          }
 163   1          
 164   1          return key_number;
 165   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    394    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
